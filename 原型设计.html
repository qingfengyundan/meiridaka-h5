<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¯æ—¥æ‰“å¡ - ä¸­å­¦ç”Ÿè‡ªå¾‹ä¹ æƒ¯åŸ¹å…»åº”ç”¨</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'SF Pro Text', sans-serif;
            background: #F2F2F7;
            min-height: 100vh;
            color: #1C1C1E;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .app-container {
            max-width: 390px;
            margin: 0 auto;
            background: #F2F2F7;
            min-height: 100vh;
            position: relative;
            overflow: hidden;
        }

        /* é¡¶éƒ¨çŠ¶æ€æ  */
        .status-bar {
            height: 47px;
            background: rgba(242, 242, 247, 0.8);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 17px;
            font-weight: 600;
            color: #1C1C1E;
            border-bottom: 0.5px solid rgba(60, 60, 67, 0.12);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        /* é¡µé¢å†…å®¹åŒºåŸŸ */
        .page {
            display: none;
            padding: 16px;
            padding-bottom: 100px;
            min-height: calc(100vh - 144px);
        }

        .page.active {
            display: block;
            animation: slideIn 0.3s ease-out;
        }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        /* é¦–é¡µæ ·å¼ */
        .welcome-section {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 20px;
            color: white;
        }

        .avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: #fff;
            margin: 0 auto 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }

        .edit-profile-btn {
            position: absolute;
            top: -5px;
            right: -5px;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.9);
            border: 1px solid rgba(0, 0, 0, 0.1);
            font-size: 12px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
            backdrop-filter: blur(10px);
        }

        .edit-profile-btn:hover {
            background: rgba(255, 255, 255, 1);
            transform: scale(1.1);
        }

        .edit-profile-btn:active {
            transform: scale(0.95);
        }

        .user-name {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .user-level {
            font-size: 14px;
            opacity: 0.9;
        }

        .points-display {
            background: rgba(255,255,255,0.2);
            padding: 10px 20px;
            border-radius: 25px;
            margin-top: 15px;
            display: inline-block;
        }

        /* ä»Šæ—¥è¿›åº¦ */
        .progress-section {
            background: #FFFFFF;
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 16px;
            border: 0.5px solid rgba(60, 60, 67, 0.12);
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
        }

        .progress-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .progress-title {
            font-size: 17px;
            font-weight: 600;
            color: #1C1C1E;
            letter-spacing: -0.4px;
        }

        .progress-stats {
            font-size: 15px;
            color: #8E8E93;
            font-weight: 500;
        }

        .progress-bar {
            height: 6px;
            background: #F2F2F7;
            border-radius: 3px;
            overflow: hidden;
            margin-bottom: 12px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #34C759, #30D158);
            border-radius: 3px;
            transition: width 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        /* ä»»åŠ¡åˆ—è¡¨ */
        .task-section {
            margin-bottom: 24px;
        }

        .section-title {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 12px;
            margin-left: 4px;
            color: #1C1C1E;
            letter-spacing: -0.4px;
        }

        .task-item {
            background: #FFFFFF;
            border-radius: 16px;
            padding: 20px 16px;
            margin-bottom: 8px;
            border: 0.5px solid rgba(60, 60, 67, 0.12);
            display: flex;
            align-items: center;
            transition: all 0.2s ease;
            gap: 16px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
        }

        .task-item:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }

        .task-item:active {
            transform: scale(0.98);
        }

        /* éšè—éå½“å¤©ä»»åŠ¡çš„æ ·å¼ */
        .task-item.hidden-task {
            display: none !important;
        }

        .task-icon {
            width: 44px;
            height: 44px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            flex-shrink: 0;
        }

        .task-icon.school { background: #E8F4FD; color: #007AFF; }
        .task-icon.home { background: #F2E8FF; color: #AF52DE; }
        .task-icon.temp { background: #FFF2E8; color: #FF9500; }

        .task-content {
            flex: 1;
            min-width: 0;
        }

        .task-name {
            font-size: 17px;
            font-weight: 600;
            margin-bottom: 6px;
            color: #1C1C1E;
            line-height: 1.3;
            letter-spacing: -0.4px;
        }

        .task-meta {
            font-size: 14px;
            color: #8E8E93;
            display: flex;
            align-items: center;
            gap: 12px;
            flex-wrap: wrap;
            line-height: 1.2;
        }

        .task-points {
            background: #F2F2F7;
            color: #007AFF;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 13px;
            font-weight: 600;
            letter-spacing: -0.2px;
        }

        .check-button {
            width: 28px;
            height: 28px;
            border: 2px solid #C7C7CC;
            border-radius: 50%;
            background: #FFFFFF;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
            flex-shrink: 0;
        }

        .check-button.completed {
            background: #34C759;
            border-color: #34C759;
            color: white;
        }

        .check-button:hover {
            transform: scale(1.05);
            border-color: #007AFF;
        }

        .check-button:active {
            transform: scale(0.95);
        }

        /* ä»»åŠ¡æ“ä½œæŒ‰é’® */
        .task-actions {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .task-actions .action-btn {
            width: 32px;
            height: 32px;
            border: none;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s ease;
            flex-shrink: 0;
        }

        .task-actions .edit-btn {
            background: #F2F2F7;
            color: #007AFF;
        }

        .task-actions .edit-btn:hover {
            background: #E5E5EA;
            transform: scale(1.05);
        }

        .task-actions .edit-btn:active {
            transform: scale(0.95);
            background: #D1D1D6;
        }

        .task-actions .delete-btn {
            background: #F2F2F7;
            color: #FF3B30;
        }

        .task-actions .delete-btn:hover {
            background: #FFE5E5;
            transform: scale(1.05);
        }

        .task-actions .delete-btn:active {
            transform: scale(0.95);
            background: #FFD1D1;
        }

        /* åº•éƒ¨å¯¼èˆª */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 390px;
            height: 83px;
            background: rgba(242, 242, 247, 0.8);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-top: 0.5px solid rgba(60, 60, 67, 0.12);
            display: flex;
            align-items: center;
            justify-content: space-around;
            padding: 8px 0 34px 0;
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            cursor: pointer;
            padding: 8px 12px;
            border-radius: 12px;
            transition: all 0.2s ease;
            min-width: 60px;
        }

        .nav-item.active {
            color: #007AFF;
        }

        .nav-item:active {
            transform: scale(0.95);
        }

        .nav-icon {
            font-size: 26px;
            margin-bottom: 4px;
        }

        .nav-label {
            font-size: 11px;
            font-weight: 500;
            color: #8E8E93;
            letter-spacing: -0.2px;
        }

        .nav-item.active .nav-label {
            color: #007AFF;
        }

        /* ç»Ÿè®¡é¡µé¢ */
        .stats-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-item {
            text-align: center;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
        }

        .stat-number {
            font-size: 24px;
            font-weight: 700;
            color: #007AFF;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 12px;
            color: #666;
        }

        /* æ·»åŠ ä»»åŠ¡é¡µé¢ */
        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 8px;
            display: block;
            color: #333;
        }

        .form-input {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 10px;
            font-size: 16px;
            background: white;
        }

        .form-input:focus {
            outline: none;
            border-color: #007AFF;
            box-shadow: 0 0 0 3px rgba(0,122,255,0.1);
        }

        .voice-btn {
            width: 48px;
            height: 48px;
            border: 1px solid #007AFF;
            border-radius: 50%;
            background: white;
            cursor: pointer;
            font-size: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            flex-shrink: 0;
        }

        .voice-btn:hover {
            background: #f0f8ff;
            transform: scale(1.05);
        }

        .voice-btn:active {
            transform: scale(0.95);
        }

        .voice-btn.recording {
            background: #ff3b30;
            border-color: #ff3b30;
            color: white;
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .category-buttons {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .category-btn {
            flex: 1;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background: white;
            cursor: pointer;
            text-align: center;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .category-btn.active {
            background: #007AFF;
            color: white;
            border-color: #007AFF;
        }

        .submit-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #007AFF, #0056CC);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s ease;
        }

        .submit-btn:hover {
            transform: translateY(-2px);
        }
        
        /* å®¶é•¿ç®¡ç†æ ·å¼ */
        .form-label {
            display: block;
            font-weight: 600;
            color: #333;
            margin-bottom: 5px;
        }
        
        .form-group {
            margin-bottom: 15px;
        }

        /* æƒé™æ§åˆ¶æ ·å¼ */
        .parent-mode .delete-btn {
            display: inline-block !important;
        }

        .parent-mode #taskPoints {
            display: block !important;
        }

        .parent-mode #studentPointsInfo {
            display: none !important;
        }

        .student-mode #taskPoints {
            display: none !important;
        }

        .student-mode #studentPointsInfo {
            display: block !important;
        }
        
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            display: none;
        }
        
        .reward-item {
            position: relative;
        }
        
        .reward-item[data-category="physical"] .task-icon {
            background: linear-gradient(135deg, #FF6B6B, #FF8E8E);
        }
        
        .reward-item[data-category="experience"] .task-icon {
            background: linear-gradient(135deg, #4ECDC4, #6EDDD6);
        }
        
        .reward-item[data-category="privilege"] .task-icon {
            background: linear-gradient(135deg, #FFD93D, #FFE066);
        }

        /* æˆå°±é¡µé¢ */
        .achievement-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .achievement-item {
            background: white;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .achievement-icon {
            font-size: 40px;
            margin-bottom: 10px;
        }

        .achievement-name {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .achievement-desc {
            font-size: 12px;
            color: #666;
        }

        .achievement-item.unlocked {
            background: linear-gradient(135deg, #FFD700, #FFA500);
            color: white;
        }

        /* åŠ¨ç”»æ•ˆæœ */
        .celebration {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 60px;
            z-index: 1000;
            animation: celebrate 1s ease-out;
            pointer-events: none;
        }

        @keyframes celebrate {
            0% { transform: translate(-50%, -50%) scale(0); opacity: 0; }
            50% { transform: translate(-50%, -50%) scale(1.2); opacity: 1; }
            100% { transform: translate(-50%, -50%) scale(1); opacity: 0; }
        }

        /* å¥–åŠ±æ“ä½œæŒ‰é’®æ ·å¼ */
        .reward-actions {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .action-btn {
            width: 36px;
            height: 36px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .edit-btn {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
        }

        .edit-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 12px rgba(76, 175, 80, 0.3);
        }

        .delete-btn {
            background: linear-gradient(135deg, #f44336, #d32f2f);
            color: white;
        }

        .delete-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 12px rgba(244, 67, 54, 0.3);
        }

        /* å­¦ç”Ÿç«¯éšè—åˆ é™¤æŒ‰é’® */
        .student-mode .delete-btn {
            display: none;
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 375px) {
            .app-container {
                max-width: 100%;
            }
            
            .bottom-nav {
                width: 100%;
            }
        }
    </style>
</head>
<body class="student-mode">
    <div class="app-container">
        <!-- çŠ¶æ€æ  -->
        <div class="status-bar">
            æ¯æ—¥æ‰“å¡ - åŸ¹å…»è‡ªå¾‹å¥½ä¹ æƒ¯
        </div>

        <!-- é¦–é¡µ/ä»Šæ—¥ä»»åŠ¡ -->
        <div class="page active" id="home">
            <!-- æ¬¢è¿åŒºåŸŸ -->
            <div class="welcome-section">
                <div class="avatar">ğŸ‘¦</div>
                <div class="user-name">å°æ˜åŒå­¦</div>
                <div class="user-level">åˆä¸­äºŒå¹´çº§ Â· è‡ªå¾‹è¾¾äºº</div>
                <div class="points-display">
                    ğŸ’ ä»Šæ—¥ç§¯åˆ†: <span id="todayPoints">85</span> | æ€»ç§¯åˆ†: <span id="totalPoints">2,340</span>
                </div>
            </div>

            <!-- ä»Šæ—¥è¿›åº¦ -->
            <div class="progress-section">
                <div class="progress-header">
                    <div class="progress-title">ä»Šæ—¥å®Œæˆè¿›åº¦</div>
                    <div class="progress-stats"><span id="completedTasks">6</span>/<span id="totalTasks">8</span> å·²å®Œæˆ</div>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 75%"></div>
                </div>
                <div style="font-size: 12px; color: #666; text-align: center;">
                    ğŸ‰ å¤ªæ£’äº†ï¼å†å®Œæˆ2ä¸ªä»»åŠ¡å°±èƒ½è·å¾—é¢å¤–å¥–åŠ±ç§¯åˆ†ï¼
                </div>
            </div>

            <!-- å­¦æ ¡ä»»åŠ¡ -->
            <div class="task-section">
                <div class="section-title">ğŸ“š å­¦æ ¡ä»»åŠ¡</div>
                <div class="task-item">
                    <div class="check-button completed" onclick="toggleTask(this)">âœ“</div>
                    <div class="task-icon school">ğŸ“–</div>
                    <div class="task-content">
                        <div class="task-name">å®Œæˆæ•°å­¦ä½œä¸š</div>
                        <div class="task-meta">
                            <span>ğŸ“… æ¯æ—¥ä»»åŠ¡</span>
                            <span>â° 20:00å‰</span>
                            <span class="task-points">+15ç§¯åˆ†</span>
                        </div>
                    </div>
                    <div class="task-actions">
                        <button class="action-btn edit-btn" onclick="editTask(1, 'å®Œæˆæ•°å­¦ä½œä¸š', 'ğŸ“–', 'school', 15, 'daily', '20:00')">âœï¸</button>
                        <button class="action-btn delete-btn" onclick="deleteTask(1, 'å®Œæˆæ•°å­¦ä½œä¸š')">ğŸ—‘ï¸</button>
                    </div>
                </div>
                
                <div class="task-item">
                    <div class="check-button" onclick="toggleTask(this)"></div>
                    <div class="task-icon school">ğŸ“</div>
                    <div class="task-content">
                        <div class="task-name">é¢„ä¹ æ˜å¤©è‹±è¯­è¯¾æ–‡</div>
                        <div class="task-meta">
                            <span>ğŸ“… æ¯æ—¥ä»»åŠ¡</span>
                            <span>â° 21:00å‰</span>
                            <span class="task-points">+10ç§¯åˆ†</span>
                        </div>
                    </div>
                    <div class="task-actions">
                        <button class="action-btn edit-btn" onclick="editTask(2, 'é¢„ä¹ æ˜å¤©è‹±è¯­è¯¾æ–‡', 'ğŸ“', 'school', 10, 'daily', '21:00')">âœï¸</button>
                        <button class="action-btn delete-btn" onclick="deleteTask(2, 'é¢„ä¹ æ˜å¤©è‹±è¯­è¯¾æ–‡')">ğŸ—‘ï¸</button>
                    </div>
                </div>

                <div class="task-item">
                    <div class="check-button completed" onclick="toggleTask(this)">âœ“</div>
                    <div class="task-icon school">ğŸƒ</div>
                    <div class="task-content">
                        <div class="task-name">ä½“è‚²é”»ç‚¼30åˆ†é’Ÿ</div>
                        <div class="task-meta">
                            <span>ğŸ“† å‘¨ä¸€ä¸‰äº”</span>
                            <span>â° 18:00å‰</span>
                            <span class="task-points">+20ç§¯åˆ†</span>
                        </div>
                    </div>
                    <div class="task-actions">
                        <button class="action-btn edit-btn" onclick="editTask(3, 'ä½“è‚²é”»ç‚¼30åˆ†é’Ÿ', 'ğŸƒ', 'school', 20, 'weekly', '18:00')">âœï¸</button>
                        <button class="action-btn delete-btn" onclick="deleteTask(3, 'ä½“è‚²é”»ç‚¼30åˆ†é’Ÿ')">ğŸ—‘ï¸</button>
                    </div>
                </div>

                <div class="task-item">
                    <div class="check-button" onclick="toggleTask(this)"></div>
                    <div class="task-icon school">ğŸ“š</div>
                    <div class="task-content">
                        <div class="task-name">å†™å‘¨è®°æ€»ç»“</div>
                        <div class="task-meta">
                            <span>ğŸ“† æ¯å‘¨æ—¥</span>
                            <span>â° 19:00å‰</span>
                            <span class="task-points">+25ç§¯åˆ†</span>
                        </div>
                    </div>
                    <div class="task-actions">
                        <button class="action-btn edit-btn" onclick="editTask(4, 'å†™å‘¨è®°æ€»ç»“', 'ğŸ“š', 'school', 25, 'weekly', '19:00')">âœï¸</button>
                        <button class="action-btn delete-btn" onclick="deleteTask(4, 'å†™å‘¨è®°æ€»ç»“')">ğŸ—‘ï¸</button>
                    </div>
                </div>
            </div>

            <!-- å®¶åº­ä»»åŠ¡ -->
            <div class="task-section">
                <div class="section-title">ğŸ  å®¶åº­ä»»åŠ¡</div>
                <div class="task-item">
                    <div class="check-button completed" onclick="toggleTask(this)">âœ“</div>
                    <div class="task-icon home">ğŸ§¹</div>
                    <div class="task-content">
                        <div class="task-name">æ•´ç†è‡ªå·±çš„æˆ¿é—´</div>
                        <div class="task-meta">
                            <span>ğŸ“† å‘¨äºŒå››å…­</span>
                            <span>â° 19:00å‰</span>
                            <span class="task-points">+12ç§¯åˆ†</span>
                        </div>
                    </div>
                    <div class="task-actions">
                        <button class="action-btn edit-btn" onclick="editTask(5, 'æ•´ç†è‡ªå·±çš„æˆ¿é—´', 'ğŸ§¹', 'home', 12, 'weekly', '19:00')">âœï¸</button>
                        <button class="action-btn delete-btn" onclick="deleteTask(5, 'æ•´ç†è‡ªå·±çš„æˆ¿é—´')">ğŸ—‘ï¸</button>
                    </div>
                </div>

                <div class="task-item">
                    <div class="check-button" onclick="toggleTask(this)"></div>
                    <div class="task-icon home">ğŸ½ï¸</div>
                    <div class="task-content">
                        <div class="task-name">å¸®å¦ˆå¦ˆæ´—ç¢—</div>
                        <div class="task-meta">
                            <span>ğŸ“… æ¯æ—¥ä»»åŠ¡</span>
                            <span>â° 20:30å‰</span>
                            <span class="task-points">+8ç§¯åˆ†</span>
                        </div>
                    </div>
                    <div class="task-actions">
                        <button class="action-btn edit-btn" onclick="editTask(6, 'å¸®å¦ˆå¦ˆæ´—ç¢—', 'ğŸ½ï¸', 'home', 8, 'daily', '20:30')">âœï¸</button>
                        <button class="action-btn delete-btn" onclick="deleteTask(6, 'å¸®å¦ˆå¦ˆæ´—ç¢—')">ğŸ—‘ï¸</button>
                    </div>
                </div>

                <div class="task-item">
                    <div class="check-button" onclick="toggleTask(this)"></div>
                    <div class="task-icon home">ğŸ›’</div>
                    <div class="task-content">
                        <div class="task-name">é™ªå¦ˆå¦ˆä¹°èœ</div>
                        <div class="task-meta">
                            <span>ğŸ“† æ¯å‘¨å…­</span>
                            <span>â° 10:00å‰</span>
                            <span class="task-points">+15ç§¯åˆ†</span>
                        </div>
                    </div>
                    <div class="task-actions">
                        <button class="action-btn edit-btn" onclick="editTask(7, 'é™ªå¦ˆå¦ˆä¹°èœ', 'ğŸ›’', 'home', 15, 'weekly', '10:00')">âœï¸</button>
                        <button class="action-btn delete-btn" onclick="deleteTask(7, 'é™ªå¦ˆå¦ˆä¹°èœ')">ğŸ—‘ï¸</button>
                    </div>
                </div>

                <div class="task-item">
                    <div class="check-button" onclick="toggleTask(this)"></div>
                    <div class="task-icon home">ğŸ’°</div>
                    <div class="task-content">
                        <div class="task-name">æ•´ç†é›¶èŠ±é’±è´¦æœ¬</div>
                        <div class="task-meta">
                            <span>ğŸ—“ï¸ æ¯æœˆ1å·</span>
                            <span>â° 21:00å‰</span>
                            <span class="task-points">+30ç§¯åˆ†</span>
                        </div>
                    </div>
                    <div class="task-actions">
                        <button class="action-btn edit-btn" onclick="editTask(8, 'æ•´ç†é›¶èŠ±é’±è´¦æœ¬', 'ğŸ’°', 'home', 30, 'monthly', '21:00')">âœï¸</button>
                        <button class="action-btn delete-btn" onclick="deleteTask(8, 'æ•´ç†é›¶èŠ±é’±è´¦æœ¬')">ğŸ—‘ï¸</button>
                    </div>
                </div>
            </div>

            <!-- ä¸´æ—¶ä»»åŠ¡ -->
            <div class="task-section">
                <div class="section-title">âš¡ ä¸´æ—¶ä»»åŠ¡</div>
                <div class="task-item">
                    <div class="check-button" onclick="toggleTask(this)"></div>
                    <div class="task-icon temp">ğŸ“š</div>
                    <div class="task-content">
                        <div class="task-name">å‡†å¤‡æ˜å¤©çš„æ¼”è®²ç¨¿</div>
                        <div class="task-meta">
                            <span>â° æ˜å¤© 08:00å‰</span>
                            <span class="task-points">+25ç§¯åˆ†</span>
                        </div>
                    </div>
                    <div class="task-actions">
                        <button class="action-btn edit-btn" onclick="editTask(9, 'å‡†å¤‡æ˜å¤©çš„æ¼”è®²ç¨¿', 'ğŸ“š', 'temp', 25, 'temp', '08:00')">âœï¸</button>
                        <button class="action-btn delete-btn" onclick="deleteTask(9, 'å‡†å¤‡æ˜å¤©çš„æ¼”è®²ç¨¿')">ğŸ—‘ï¸</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- ä»»åŠ¡ç®¡ç†é¡µé¢ -->
        <div class="page" id="tasks">
            <div class="section-title">â• æ·»åŠ æ–°ä»»åŠ¡</div>
            
            <div class="form-group">
                <label class="form-label">ä»»åŠ¡åç§°</label>
                <div style="position: relative; display: flex; align-items: center; gap: 10px;">
                    <input type="text" class="form-input" placeholder="è¯·è¾“å…¥ä»»åŠ¡åç§°æˆ–ç‚¹å‡»è¯­éŸ³è¾“å…¥" id="taskName" style="flex: 1;">
                    <button class="voice-btn" id="voiceBtn" onclick="toggleVoiceInput()" title="è¯­éŸ³è¾“å…¥">
                        ğŸ¤
                    </button>
                </div>
                <div id="voiceStatus" style="display: none; margin-top: 8px; padding: 8px; background: #f0f8ff; border-radius: 8px; font-size: 14px; color: #007AFF;">
                    <span id="voiceStatusText">æ­£åœ¨è†å¬...</span>
                </div>
            </div>

            <div class="form-group">
                <label class="form-label">ä»»åŠ¡åˆ†ç±»</label>
                <div class="category-buttons">
                    <div class="category-btn active" onclick="selectCategory(this, 'school')">ğŸ“š å­¦æ ¡</div>
                    <div class="category-btn" onclick="selectCategory(this, 'home')">ğŸ  å®¶åº­</div>
                    <div class="category-btn" onclick="selectCategory(this, 'temp')">âš¡ ä¸´æ—¶</div>
                </div>
            </div>

            <div class="form-group" id="pointsGroup" style="display: none;">
                <label class="form-label">ç§¯åˆ†å¥–åŠ±</label>
                <input type="number" class="form-input" placeholder="å®Œæˆä»»åŠ¡å¯è·å¾—çš„ç§¯åˆ†" id="taskPoints" value="1">
            </div>
            
            <!-- å­¦ç”Ÿç«¯æ˜¾ç¤ºçš„ç§¯åˆ†ä¿¡æ¯ -->
            <div class="form-group" id="studentPointsInfo">
                <label class="form-label">ç§¯åˆ†å¥–åŠ±</label>
                <div style="padding: 12px 15px; background: #f8f9fa; border-radius: 10px; color: #666; font-size: 16px;">
                    ğŸ† å®Œæˆä»»åŠ¡å¯è·å¾— 1 ç§¯åˆ†
                </div>
            </div>

            <div class="form-group">
                <label class="form-label">ä»»åŠ¡é¢‘ç‡</label>
                <div class="category-buttons">
                    <div class="category-btn active" onclick="selectFrequency(this, 'daily')">ğŸ“… æ¯æ—¥</div>
                    <div class="category-btn" onclick="selectFrequency(this, 'weekly')">ğŸ“† æ¯å‘¨</div>
                    <div class="category-btn" onclick="selectFrequency(this, 'monthly')">ğŸ—“ï¸ æ¯æœˆ</div>
                </div>
            </div>

            <div class="form-group" id="weeklyOptions" style="display: none;">
                <label class="form-label">é€‰æ‹©æ˜ŸæœŸå‡ </label>
                <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px;">
                    <div class="category-btn" onclick="toggleWeekday(this, 1)">å‘¨ä¸€</div>
                    <div class="category-btn" onclick="toggleWeekday(this, 2)">å‘¨äºŒ</div>
                    <div class="category-btn" onclick="toggleWeekday(this, 3)">å‘¨ä¸‰</div>
                    <div class="category-btn" onclick="toggleWeekday(this, 4)">å‘¨å››</div>
                    <div class="category-btn" onclick="toggleWeekday(this, 5)">å‘¨äº”</div>
                    <div class="category-btn" onclick="toggleWeekday(this, 6)">å‘¨å…­</div>
                    <div class="category-btn" onclick="toggleWeekday(this, 0)">å‘¨æ—¥</div>
                    <div></div>
                </div>
            </div>

            <div class="form-group" id="monthlyOptions" style="display: none;">
                <label class="form-label">é€‰æ‹©æ—¥æœŸ</label>
                <input type="number" class="form-input" placeholder="æ¯æœˆå‡ å·æ‰§è¡Œ (1-31)" id="monthlyDate" min="1" max="31">
            </div>

            <div class="form-group">
                <label class="form-label">å®Œæˆæ—¶é—´</label>
                <input type="time" class="form-input" id="taskTime" value="20:00">
            </div>

            <div class="form-group">
                <label class="form-label">ä»»åŠ¡æè¿°</label>
                <textarea class="form-input" rows="3" placeholder="è¯¦ç»†æè¿°ä»»åŠ¡å†…å®¹ï¼ˆå¯é€‰ï¼‰" id="taskDesc"></textarea>
            </div>

            <button class="submit-btn" onclick="addTask()">
                âœ¨ åˆ›å»ºä»»åŠ¡
            </button>

            <div style="margin-top: 30px;">
                <div class="section-title">ğŸ“‹ æˆ‘çš„ä»»åŠ¡æ¨¡æ¿</div>
                <div class="task-item" onclick="useTemplate('å®Œæˆæ•°å­¦ä½œä¸š', 'school', 15, 'daily')">
                    <div class="task-icon school">ğŸ“–</div>
                    <div class="task-content">
                        <div class="task-name">å®Œæˆæ•°å­¦ä½œä¸š</div>
                        <div class="task-meta">
                            <span>ğŸ“… æ¯æ—¥ä»»åŠ¡</span>
                            <span class="task-points">+15ç§¯åˆ†</span>
                        </div>
                    </div>
                </div>
                
                <div class="task-item" onclick="useTemplate('ä½“è‚²é”»ç‚¼', 'school', 20, 'weekly')">
                    <div class="task-icon school">ğŸƒ</div>
                    <div class="task-content">
                        <div class="task-name">ä½“è‚²é”»ç‚¼</div>
                        <div class="task-meta">
                            <span>ğŸ“† æ¯å‘¨ä»»åŠ¡</span>
                            <span class="task-points">+20ç§¯åˆ†</span>
                        </div>
                    </div>
                </div>
                
                <div class="task-item" onclick="useTemplate('æ•´ç†æˆ¿é—´', 'home', 12, 'weekly')">
                    <div class="task-icon home">ğŸ§¹</div>
                    <div class="task-content">
                        <div class="task-name">æ•´ç†æˆ¿é—´</div>
                        <div class="task-meta">
                            <span>ğŸ“† æ¯å‘¨ä»»åŠ¡</span>
                            <span class="task-points">+12ç§¯åˆ†</span>
                        </div>
                    </div>
                </div>

                <div class="task-item" onclick="useTemplate('æ•´ç†é›¶èŠ±é’±è´¦æœ¬', 'home', 30, 'monthly')">
                    <div class="task-icon home">ğŸ’°</div>
                    <div class="task-content">
                        <div class="task-name">æ•´ç†é›¶èŠ±é’±è´¦æœ¬</div>
                        <div class="task-meta">
                            <span>ğŸ—“ï¸ æ¯æœˆä»»åŠ¡</span>
                            <span class="task-points">+30ç§¯åˆ†</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- æ•°æ®ç»Ÿè®¡é¡µé¢ -->
        <div class="page" id="stats">
            <div class="section-title">ğŸ“Š æˆ‘çš„æˆé•¿æ•°æ®</div>
            
            <div class="stats-card">
                <div class="progress-title" style="margin-bottom: 15px;">æœ¬å‘¨å®Œæˆæƒ…å†µ</div>
                <div class="stats-grid">
                    <div class="stat-item">
                        <div class="stat-number">42</div>
                        <div class="stat-label">å·²å®Œæˆä»»åŠ¡</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number">89%</div>
                        <div class="stat-label">å®Œæˆç‡</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number">520</div>
                        <div class="stat-label">è·å¾—ç§¯åˆ†</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number">7</div>
                        <div class="stat-label">è¿ç»­æ‰“å¡</div>
                    </div>
                </div>
            </div>

            <div class="stats-card">
                <div class="progress-title" style="margin-bottom: 15px;">ç§¯åˆ†è¶‹åŠ¿</div>
                <div style="height: 120px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 10px; display: flex; align-items: center; justify-content: center; color: white; font-size: 16px;">
                    ğŸ“ˆ ç§¯åˆ†ç¨³æ­¥ä¸Šå‡ä¸­ï¼
                </div>
            </div>

            <div class="stats-card">
                <div class="progress-title" style="margin-bottom: 15px;">ä»»åŠ¡åˆ†ç±»ç»Ÿè®¡</div>
                <div class="task-item">
                    <div class="task-icon school">ğŸ“š</div>
                    <div class="task-content">
                        <div class="task-name">å­¦æ ¡ä»»åŠ¡</div>
                        <div class="task-meta">
                            <span>æœ¬å‘¨å®Œæˆ 18/20</span>
                            <span class="task-points">90%</span>
                        </div>
                    </div>
                </div>
                
                <div class="task-item">
                    <div class="task-icon home">ğŸ </div>
                    <div class="task-content">
                        <div class="task-name">å®¶åº­ä»»åŠ¡</div>
                        <div class="task-meta">
                            <span>æœ¬å‘¨å®Œæˆ 15/16</span>
                            <span class="task-points">94%</span>
                        </div>
                    </div>
                </div>

                <div class="task-item">
                    <div class="task-icon temp">âš¡</div>
                    <div class="task-content">
                        <div class="task-name">ä¸´æ—¶ä»»åŠ¡</div>
                        <div class="task-meta">
                            <span>æœ¬å‘¨å®Œæˆ 9/12</span>
                            <span class="task-points">75%</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ä¸ªäººä¸­å¿ƒé¡µé¢ -->
        <div class="page" id="profile">
            <div class="welcome-section">
                <div style="position: relative;">
                    <div class="avatar">ğŸ‘¦</div>
                    <button class="edit-profile-btn" onclick="openProfileEditor()" title="ç¼–è¾‘ä¸ªäººèµ„æ–™">âœï¸</button>
                </div>
                <div class="user-name">å°æ˜åŒå­¦</div>
                <div class="user-level">åˆä¸­äºŒå¹´çº§ Â· è‡ªå¾‹è¾¾äºº Lv.8</div>
                <div class="points-display">
                    ğŸ’ æ€»ç§¯åˆ†: 2,340 | ğŸ† æˆå°±: 12ä¸ª
                </div>
                <div style="margin-top: 15px;">
                    <button class="category-btn" onclick="switchToParentMode()">ğŸ‘© åˆ‡æ¢åˆ°å®¶é•¿æ¨¡å¼</button>
                </div>
            </div>

            <div class="section-title">ğŸ† æˆ‘çš„æˆå°±</div>
            <div class="achievement-grid">
                <div class="achievement-item unlocked">
                    <div class="achievement-icon">ğŸ”¥</div>
                    <div class="achievement-name">è¿ç»­æ‰“å¡ç‹</div>
                    <div class="achievement-desc">è¿ç»­æ‰“å¡7å¤©</div>
                </div>
                
                <div class="achievement-item unlocked">
                    <div class="achievement-icon">ğŸ“š</div>
                    <div class="achievement-name">å­¦éœ¸å…»æˆ</div>
                    <div class="achievement-desc">å®Œæˆ100ä¸ªå­¦æ ¡ä»»åŠ¡</div>
                </div>
                
                <div class="achievement-item">
                    <div class="achievement-icon">â­</div>
                    <div class="achievement-name">ç§¯åˆ†è¾¾äºº</div>
                    <div class="achievement-desc">ç´¯è®¡è·å¾—5000ç§¯åˆ†</div>
                </div>
                
                <div class="achievement-item">
                    <div class="achievement-icon">ğŸ¯</div>
                    <div class="achievement-name">å®Œç¾ä¸»ä¹‰</div>
                    <div class="achievement-desc">å•å‘¨å®Œæˆç‡100%</div>
                </div>
            </div>

            <div style="margin-top: 30px;">
                <div class="section-title">âš™ï¸ è®¾ç½®é€‰é¡¹</div>
                <div class="task-item">
                    <div class="task-icon school">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦</div>
                    <div class="task-content">
                        <div class="task-name">å®¶é•¿å…³è”</div>
                        <div class="task-meta">
                            <span>å·²å…³è”: çˆ¸çˆ¸å¦ˆå¦ˆ</span>
                        </div>
                    </div>
                </div>
                
                <div class="task-item">
                    <div class="task-icon home">ğŸ””</div>
                    <div class="task-content">
                        <div class="task-name">æé†’è®¾ç½®</div>
                        <div class="task-meta">
                            <span>æ¯æ—¥ 19:00 æé†’æ‰“å¡</span>
                        </div>
                    </div>
                </div>

                <div class="task-item">
                    <div class="task-icon temp">ğŸ“Š</div>
                    <div class="task-content">
                        <div class="task-name">æ•°æ®å¯¼å‡º</div>
                        <div class="task-meta">
                            <span>å¯¼å‡ºå­¦ä¹ æŠ¥å‘Š</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- å®¶é•¿ç®¡ç†é¡µé¢ -->
        <div class="page" id="parent-mode">
            <div class="welcome-section">
                <div class="avatar">ğŸ‘©</div>
                <div class="user-name">å°æ˜å¦ˆå¦ˆ</div>
                <div class="user-level">å®¶é•¿ç®¡ç†å‘˜</div>
                <div class="points-display">
                    ğŸ‘¦ ç®¡ç†å­©å­: å°æ˜åŒå­¦
                </div>
                <div style="margin-top: 15px;">
                    <button class="category-btn" onclick="switchToChildMode()">ğŸ‘¦ åˆ‡æ¢åˆ°å­©å­æ¨¡å¼</button>
                </div>
            </div>

            <div class="section-title">ğŸ“‹ ä»»åŠ¡ç®¡ç†</div>
            <div class="task-item" onclick="openTaskPointsManagement()">
                <div class="task-icon school">ğŸ†</div>
                <div class="task-content">
                    <div class="task-name">ä»»åŠ¡ç§¯åˆ†ç®¡ç†</div>
                    <div class="task-meta">
                        <span>è®¾ç½®å„ä»»åŠ¡çš„ç§¯åˆ†å¥–åŠ±</span>
                    </div>
                </div>
            </div>

            <div class="section-title">ğŸ å¥–åŠ±ç®¡ç†</div>
            <div class="task-item" onclick="showRewardManagement()">
                <div class="task-icon school">ğŸ</div>
                <div class="task-content">
                    <div class="task-name">ç®¡ç†å¥–åŠ±å•†å“</div>
                    <div class="task-meta">
                        <span>å½“å‰æœ‰ 8 ä¸ªå¥–åŠ±é¡¹ç›®</span>
                    </div>
                </div>
            </div>

            <div class="task-item">
                <div class="task-icon home">ğŸ“Š</div>
                <div class="task-content">
                    <div class="task-name">å­©å­æ•°æ®åˆ†æ</div>
                    <div class="task-meta">
                        <span>æŸ¥çœ‹è¯¦ç»†å­¦ä¹ æŠ¥å‘Š</span>
                    </div>
                </div>
            </div>

            <div class="task-item">
                <div class="task-icon temp">â°</div>
                <div class="task-content">
                    <div class="task-name">æé†’è®¾ç½®</div>
                    <div class="task-meta">
                        <span>ç®¡ç†æ‰“å¡æé†’æ—¶é—´</span>
                    </div>
                </div>
            </div>

            <div class="task-item">
                <div class="task-icon school">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦</div>
                <div class="task-content">
                    <div class="task-name">å®¶åº­æˆå‘˜</div>
                    <div class="task-meta">
                        <span>ç®¡ç†å®¶åº­æˆå‘˜æƒé™</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- å¥–åŠ±ç®¡ç†é¡µé¢ -->
        <div class="page" id="reward-management">
            <div style="display: flex; align-items: center; margin-bottom: 20px;">
                <button class="category-btn" onclick="backToParentMode()" style="margin-right: 15px;">â† è¿”å›</button>
                <div class="section-title" style="margin: 0; flex: 1;">ğŸ å¥–åŠ±ç®¡ç†</div>
                <button class="category-btn" onclick="showAddReward()">+ æ·»åŠ </button>
            </div>
            
            <div class="category-buttons" style="margin-bottom: 20px;">
                <button class="category-btn active" onclick="filterRewards('all')">å…¨éƒ¨</button>
                <button class="category-btn" onclick="filterRewards('physical')">å®ç‰©</button>
                <button class="category-btn" onclick="filterRewards('experience')">ä½“éªŒ</button>
                <button class="category-btn" onclick="filterRewards('privilege')">ç‰¹æƒ</button>
            </div>
            
            <div class="reward-list">
                <div class="task-item reward-item" data-category="physical">
                     <div class="task-icon school">ğŸ®</div>
                     <div class="task-content">
                         <div class="task-name">æ¸¸æˆæœº30åˆ†é’Ÿ</div>
                         <div class="task-meta">
                             <span>éœ€è¦ç§¯åˆ†: 200</span>
                             <span class="task-points">å·²å¯ç”¨</span>
                         </div>
                     </div>
                     <div class="reward-actions">
                         <button class="action-btn edit-btn" onclick="editReward(1, 'æ¸¸æˆæœº30åˆ†é’Ÿ', 'ğŸ®', 'physical', 200, 'å¯ä»¥ç©æ¸¸æˆæœº30åˆ†é’Ÿ')">âœï¸</button>
                         <button class="action-btn delete-btn" onclick="deleteReward(1, 'æ¸¸æˆæœº30åˆ†é’Ÿ')">ğŸ—‘ï¸</button>
                     </div>
                 </div>
                
                <div class="task-item reward-item" data-category="experience">
                    <div class="task-icon home">ğŸ¬</div>
                    <div class="task-content">
                        <div class="task-name">çœ‹ç”µå½±</div>
                        <div class="task-meta">
                            <span>éœ€è¦ç§¯åˆ†: 300</span>
                            <span class="task-points">å·²å¯ç”¨</span>
                        </div>
                    </div>
                    <div class="reward-actions">
                        <button class="action-btn edit-btn" onclick="editReward(2, 'çœ‹ç”µå½±', 'ğŸ¬', 'experience', 300, 'å¯ä»¥çœ‹ä¸€éƒ¨ç”µå½±')">âœï¸</button>
                        <button class="action-btn delete-btn" onclick="deleteReward(2, 'çœ‹ç”µå½±')">ğŸ—‘ï¸</button>
                    </div>
                </div>
                
                <div class="task-item reward-item" data-category="privilege">
                    <div class="task-icon temp">ğŸ›ï¸</div>
                    <div class="task-content">
                        <div class="task-name">æ™šç¡30åˆ†é’Ÿ</div>
                        <div class="task-meta">
                            <span>éœ€è¦ç§¯åˆ†: 150</span>
                            <span class="task-points">å·²å¯ç”¨</span>
                        </div>
                    </div>
                    <div class="reward-actions">
                        <button class="action-btn edit-btn" onclick="editReward(3, 'æ™šç¡30åˆ†é’Ÿ', 'ğŸ›ï¸', 'privilege', 150, 'å¯ä»¥æ¯”å¹³æ—¶æ™šç¡30åˆ†é’Ÿ')">âœï¸</button>
                        <button class="action-btn delete-btn" onclick="deleteReward(3, 'æ™šç¡30åˆ†é’Ÿ')">ğŸ—‘ï¸</button>
                    </div>
                </div>
                
                <div class="task-item reward-item" data-category="physical">
                    <div class="task-icon school">ğŸ¦</div>
                    <div class="task-content">
                        <div class="task-name">å†°æ·‡æ·‹</div>
                        <div class="task-meta">
                            <span>éœ€è¦ç§¯åˆ†: 100</span>
                            <span style="color: #999;">å·²ç¦ç”¨</span>
                        </div>
                    </div>
                    <div class="reward-actions">
                        <button class="action-btn edit-btn" onclick="editReward(4, 'å†°æ·‡æ·‹', 'ğŸ¦', 'physical', 100, 'ç¾å‘³çš„å†°æ·‡æ·‹')">âœï¸</button>
                        <button class="action-btn delete-btn" onclick="deleteReward(4, 'å†°æ·‡æ·‹')">ğŸ—‘ï¸</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- æ·»åŠ å¥–åŠ±å¼¹çª— -->
        <div class="modal" id="add-reward-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000;">
            <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; border-radius: 15px; padding: 20px; width: 90%; max-width: 350px;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <div class="section-title" style="margin: 0;">æ·»åŠ æ–°å¥–åŠ±</div>
                    <button onclick="closeAddReward()" style="background: none; border: none; font-size: 24px; cursor: pointer;">Ã—</button>
                </div>
                
                <div class="form-group">
                    <label class="form-label">å¥–åŠ±åç§°</label>
                    <input type="text" class="form-input" id="rewardName" placeholder="è¯·è¾“å…¥å¥–åŠ±åç§°">
                </div>
                
                <div class="form-group">
                    <label class="form-label">å¥–åŠ±å›¾æ ‡</label>
                    <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px;">
                        <button class="category-btn active" onclick="selectRewardIcon(this, 'ğŸ®')">ğŸ®</button>
                        <button class="category-btn" onclick="selectRewardIcon(this, 'ğŸ¬')">ğŸ¬</button>
                        <button class="category-btn" onclick="selectRewardIcon(this, 'ğŸ¦')">ğŸ¦</button>
                        <button class="category-btn" onclick="selectRewardIcon(this, 'ğŸ')">ğŸ</button>
                        <button class="category-btn" onclick="selectRewardIcon(this, 'ğŸ†')">ğŸ†</button>
                        <button class="category-btn" onclick="selectRewardIcon(this, 'â­')">â­</button>
                        <button class="category-btn" onclick="selectRewardIcon(this, 'ğŸˆ')">ğŸˆ</button>
                        <button class="category-btn" onclick="selectRewardIcon(this, 'ğŸ›ï¸')">ğŸ›ï¸</button>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">å¥–åŠ±ç±»å‹</label>
                    <div class="category-buttons">
                        <button class="category-btn active" onclick="selectRewardType(this, 'physical')">å®ç‰©</button>
                        <button class="category-btn" onclick="selectRewardType(this, 'experience')">ä½“éªŒ</button>
                        <button class="category-btn" onclick="selectRewardType(this, 'privilege')">ç‰¹æƒ</button>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">æ‰€éœ€ç§¯åˆ†</label>
                    <input type="number" class="form-input" id="rewardPoints" placeholder="è¯·è¾“å…¥æ‰€éœ€ç§¯åˆ†" min="1">
                </div>
                
                <div class="form-group">
                    <label class="form-label">å¥–åŠ±æè¿°</label>
                    <textarea class="form-input" id="rewardDescription" rows="3" placeholder="è¯·è¾“å…¥å¥–åŠ±æè¿°ï¼ˆå¯é€‰ï¼‰"></textarea>
                </div>
                
                <div style="display: flex; gap: 10px; margin-top: 20px;">
                    <button class="category-btn" onclick="closeAddReward()" style="flex: 1;">å–æ¶ˆ</button>
                    <button class="submit-btn" onclick="addNewReward()" style="flex: 1;">æ·»åŠ </button>
                </div>
            </div>
        </div>

        <!-- ä»»åŠ¡ç§¯åˆ†ç®¡ç†é¡µé¢ -->
        <div class="page" id="task-points-management" style="display: none;">
            <div style="display: flex; align-items: center; margin-bottom: 20px;">
                <button class="category-btn" onclick="backToParentMode()" style="margin-right: 15px;">â† è¿”å›</button>
                <div class="section-title" style="margin: 0; flex: 1;">ğŸ† ä»»åŠ¡ç§¯åˆ†ç®¡ç†</div>
            </div>
            
            <div class="category-buttons" style="margin-bottom: 20px;">
                <button class="category-btn active" onclick="filterTasksByCategory('all')">å…¨éƒ¨</button>
                <button class="category-btn" onclick="filterTasksByCategory('school')">å­¦æ ¡</button>
                <button class="category-btn" onclick="filterTasksByCategory('home')">å®¶åº­</button>
                <button class="category-btn" onclick="filterTasksByCategory('temp')">ä¸´æ—¶</button>
            </div>
            
            <div class="task-points-list">
                <!-- å­¦æ ¡ä»»åŠ¡ -->
                <div class="task-item task-points-item" data-category="school">
                    <div class="task-icon school">ğŸ“š</div>
                    <div class="task-content">
                        <div class="task-name">å®Œæˆæ•°å­¦ä½œä¸š</div>
                        <div class="task-meta">
                            <span>å­¦æ ¡ä»»åŠ¡</span>
                            <span class="task-points">å½“å‰: 1ç§¯åˆ†</span>
                        </div>
                    </div>
                    <div class="task-actions">
                        <button class="action-btn edit-btn" onclick="editTaskPoints('å®Œæˆæ•°å­¦ä½œä¸š', 1)">âœï¸</button>
                    </div>
                </div>

                <div class="task-item task-points-item" data-category="school">
                    <div class="task-icon school">ğŸ“–</div>
                    <div class="task-content">
                        <div class="task-name">é¢„ä¹ æ˜å¤©è‹±è¯­è¯¾æ–‡</div>
                        <div class="task-meta">
                            <span>å­¦æ ¡ä»»åŠ¡</span>
                            <span class="task-points">å½“å‰: 1ç§¯åˆ†</span>
                        </div>
                    </div>
                    <div class="task-actions">
                        <button class="action-btn edit-btn" onclick="editTaskPoints('é¢„ä¹ æ˜å¤©è‹±è¯­è¯¾æ–‡', 1)">âœï¸</button>
                    </div>
                </div>

                <div class="task-item task-points-item" data-category="school">
                    <div class="task-icon school">ğŸƒ</div>
                    <div class="task-content">
                        <div class="task-name">ä½“è‚²é”»ç‚¼30åˆ†é’Ÿ</div>
                        <div class="task-meta">
                            <span>å­¦æ ¡ä»»åŠ¡</span>
                            <span class="task-points">å½“å‰: 1ç§¯åˆ†</span>
                        </div>
                    </div>
                    <div class="task-actions">
                        <button class="action-btn edit-btn" onclick="editTaskPoints('ä½“è‚²é”»ç‚¼30åˆ†é’Ÿ', 1)">âœï¸</button>
                    </div>
                </div>

                <!-- å®¶åº­ä»»åŠ¡ -->
                <div class="task-item task-points-item" data-category="home">
                    <div class="task-icon home">ğŸ </div>
                    <div class="task-content">
                        <div class="task-name">æ•´ç†è‡ªå·±çš„æˆ¿é—´</div>
                        <div class="task-meta">
                            <span>å®¶åº­ä»»åŠ¡</span>
                            <span class="task-points">å½“å‰: 1ç§¯åˆ†</span>
                        </div>
                    </div>
                    <div class="task-actions">
                        <button class="action-btn edit-btn" onclick="editTaskPoints('æ•´ç†è‡ªå·±çš„æˆ¿é—´', 1)">âœï¸</button>
                    </div>
                </div>

                <div class="task-item task-points-item" data-category="home">
                    <div class="task-icon home">ğŸ½ï¸</div>
                    <div class="task-content">
                        <div class="task-name">å¸®å¦ˆå¦ˆæ´—ç¢—</div>
                        <div class="task-meta">
                            <span>å®¶åº­ä»»åŠ¡</span>
                            <span class="task-points">å½“å‰: 1ç§¯åˆ†</span>
                        </div>
                    </div>
                    <div class="task-actions">
                        <button class="action-btn edit-btn" onclick="editTaskPoints('å¸®å¦ˆå¦ˆæ´—ç¢—', 1)">âœï¸</button>
                    </div>
                </div>

                <!-- ä¸´æ—¶ä»»åŠ¡ -->
                <div class="task-item task-points-item" data-category="temp">
                    <div class="task-icon temp">ğŸ“š</div>
                    <div class="task-content">
                        <div class="task-name">å‡†å¤‡æ˜å¤©çš„æ¼”è®²ç¨¿</div>
                        <div class="task-meta">
                            <span>ä¸´æ—¶ä»»åŠ¡</span>
                            <span class="task-points">å½“å‰: 1ç§¯åˆ†</span>
                        </div>
                    </div>
                    <div class="task-actions">
                        <button class="action-btn edit-btn" onclick="editTaskPoints('å‡†å¤‡æ˜å¤©çš„æ¼”è®²ç¨¿', 1)">âœï¸</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- ç¼–è¾‘ä»»åŠ¡ç§¯åˆ†å¼¹çª— -->
        <div class="modal" id="edit-task-points-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000;">
            <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; border-radius: 15px; padding: 20px; width: 90%; max-width: 350px;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <div class="section-title" style="margin: 0;">ä¿®æ”¹ä»»åŠ¡ç§¯åˆ†</div>
                    <button onclick="closeEditTaskPoints()" style="background: none; border: none; font-size: 24px; cursor: pointer;">Ã—</button>
                </div>
                
                <div class="form-group">
                    <label class="form-label">ä»»åŠ¡åç§°</label>
                    <div style="padding: 12px 15px; background: #f8f9fa; border-radius: 10px; color: #666; font-size: 16px;" id="editTaskName">
                        ä»»åŠ¡åç§°
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">ç§¯åˆ†å¥–åŠ±</label>
                    <input type="number" class="form-input" id="editTaskPointsInput" placeholder="è¯·è¾“å…¥ç§¯åˆ†æ•°é‡" min="1" max="100" value="1">
                    <div style="font-size: 12px; color: #666; margin-top: 5px;">
                        å»ºè®®èŒƒå›´ï¼š1-10ç§¯åˆ†ï¼ˆæ—¥å¸¸ä»»åŠ¡ï¼‰ï¼Œ10-50ç§¯åˆ†ï¼ˆé‡è¦ä»»åŠ¡ï¼‰ï¼Œ50-100ç§¯åˆ†ï¼ˆç‰¹æ®Šä»»åŠ¡ï¼‰
                    </div>
                </div>
                
                <div style="display: flex; gap: 10px; margin-top: 20px;">
                    <button class="category-btn" onclick="closeEditTaskPoints()" style="flex: 1;">å–æ¶ˆ</button>
                    <button class="submit-btn" onclick="saveTaskPoints()" style="flex: 1;">ä¿å­˜</button>
                </div>
            </div>
        </div>

        <!-- ç¼–è¾‘ä¸ªäººèµ„æ–™å¼¹çª— -->
        <div class="modal" id="edit-profile-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000;">
            <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; border-radius: 15px; padding: 20px; width: 90%; max-width: 350px;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <div class="section-title" style="margin: 0;">ç¼–è¾‘ä¸ªäººèµ„æ–™</div>
                    <button onclick="closeProfileEditor()" style="background: none; border: none; font-size: 24px; cursor: pointer;">Ã—</button>
                </div>
                
                <div class="form-group">
                    <label class="form-label">é€‰æ‹©å¤´åƒ</label>
                    <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-bottom: 15px;">
                        <button class="avatar-option active" onclick="selectAvatar(this, 'ğŸ‘¦')" style="width: 50px; height: 50px; border-radius: 50%; background: #f0f0f0; border: 2px solid #007AFF; font-size: 20px; cursor: pointer;">ğŸ‘¦</button>
                        <button class="avatar-option" onclick="selectAvatar(this, 'ğŸ‘§')" style="width: 50px; height: 50px; border-radius: 50%; background: #f0f0f0; border: 2px solid #ddd; font-size: 20px; cursor: pointer;">ğŸ‘§</button>
                        <button class="avatar-option" onclick="selectAvatar(this, 'ğŸ§‘')" style="width: 50px; height: 50px; border-radius: 50%; background: #f0f0f0; border: 2px solid #ddd; font-size: 20px; cursor: pointer;">ğŸ§‘</button>
                        <button class="avatar-option" onclick="selectAvatar(this, 'ğŸ‘¨')" style="width: 50px; height: 50px; border-radius: 50%; background: #f0f0f0; border: 2px solid #ddd; font-size: 20px; cursor: pointer;">ğŸ‘¨</button>
                        <button class="avatar-option" onclick="selectAvatar(this, 'ğŸ‘©')" style="width: 50px; height: 50px; border-radius: 50%; background: #f0f0f0; border: 2px solid #ddd; font-size: 20px; cursor: pointer;">ğŸ‘©</button>
                        <button class="avatar-option" onclick="selectAvatar(this, 'ğŸ§’')" style="width: 50px; height: 50px; border-radius: 50%; background: #f0f0f0; border: 2px solid #ddd; font-size: 20px; cursor: pointer;">ğŸ§’</button>
                        <button class="avatar-option" onclick="selectAvatar(this, 'ğŸ±')" style="width: 50px; height: 50px; border-radius: 50%; background: #f0f0f0; border: 2px solid #ddd; font-size: 20px; cursor: pointer;">ğŸ±</button>
                        <button class="avatar-option" onclick="selectAvatar(this, 'ğŸ¶')" style="width: 50px; height: 50px; border-radius: 50%; background: #f0f0f0; border: 2px solid #ddd; font-size: 20px; cursor: pointer;">ğŸ¶</button>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">å§“å</label>
                    <input type="text" class="form-input" id="profileName" placeholder="è¯·è¾“å…¥å§“å" value="å°æ˜åŒå­¦">
                </div>
                
                <div class="form-group">
                    <label class="form-label">å¹´çº§</label>
                    <select class="form-input" id="profileGrade">
                        <option value="å°å­¦ä¸€å¹´çº§">å°å­¦ä¸€å¹´çº§</option>
                        <option value="å°å­¦äºŒå¹´çº§">å°å­¦äºŒå¹´çº§</option>
                        <option value="å°å­¦ä¸‰å¹´çº§">å°å­¦ä¸‰å¹´çº§</option>
                        <option value="å°å­¦å››å¹´çº§">å°å­¦å››å¹´çº§</option>
                        <option value="å°å­¦äº”å¹´çº§">å°å­¦äº”å¹´çº§</option>
                        <option value="å°å­¦å…­å¹´çº§">å°å­¦å…­å¹´çº§</option>
                        <option value="åˆä¸­ä¸€å¹´çº§">åˆä¸­ä¸€å¹´çº§</option>
                        <option value="åˆä¸­äºŒå¹´çº§" selected>åˆä¸­äºŒå¹´çº§</option>
                        <option value="åˆä¸­ä¸‰å¹´çº§">åˆä¸­ä¸‰å¹´çº§</option>
                        <option value="é«˜ä¸­ä¸€å¹´çº§">é«˜ä¸­ä¸€å¹´çº§</option>
                        <option value="é«˜ä¸­äºŒå¹´çº§">é«˜ä¸­äºŒå¹´çº§</option>
                        <option value="é«˜ä¸­ä¸‰å¹´çº§">é«˜ä¸­ä¸‰å¹´çº§</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label class="form-label">ä¸ªæ€§ç§°å·</label>
                    <select class="form-input" id="profileTitle">
                        <option value="å­¦ä¹ æ–°æ‰‹">å­¦ä¹ æ–°æ‰‹</option>
                        <option value="åŠªåŠ›å­¦éœ¸">åŠªåŠ›å­¦éœ¸</option>
                        <option value="è‡ªå¾‹è¾¾äºº" selected>è‡ªå¾‹è¾¾äºº</option>
                        <option value="æ—¶é—´ç®¡ç†å¤§å¸ˆ">æ—¶é—´ç®¡ç†å¤§å¸ˆ</option>
                        <option value="å®Œç¾ä¸»ä¹‰è€…">å®Œç¾ä¸»ä¹‰è€…</option>
                        <option value="ç§¯åˆ†æ”¶é›†å®¶">ç§¯åˆ†æ”¶é›†å®¶</option>
                        <option value="ä¹ æƒ¯å…»æˆç‹">ä¹ æƒ¯å…»æˆç‹</option>
                    </select>
                </div>
                
                <div style="display: flex; gap: 10px; margin-top: 20px;">
                    <button class="category-btn" onclick="closeProfileEditor()" style="flex: 1;">å–æ¶ˆ</button>
                    <button class="submit-btn" onclick="saveProfile()" style="flex: 1;">ä¿å­˜</button>
                </div>
            </div>
        </div>

        <!-- ç§¯åˆ†å•†åŸé¡µé¢ -->
        <div class="page" id="shop">
            <div class="section-title">ğŸ›ï¸ ç§¯åˆ†å•†åŸ</div>
            
            <div class="stats-card">
                <div class="progress-title" style="margin-bottom: 15px;">æˆ‘çš„ç§¯åˆ†é’±åŒ…</div>
                <div style="text-align: center; padding: 20px;">
                    <div style="font-size: 36px; font-weight: 700; color: #007AFF; margin-bottom: 10px;">2,340</div>
                    <div style="color: #666;">å¯ç”¨ç§¯åˆ†</div>
                </div>
            </div>

            <div class="section-title">ğŸ è™šæ‹Ÿå¥–åŠ±</div>
            <div class="achievement-grid">
                <div class="achievement-item">
                    <div class="achievement-icon">ğŸ¨</div>
                    <div class="achievement-name">æ–°å¤´åƒ</div>
                    <div class="achievement-desc">100ç§¯åˆ†</div>
                </div>
                
                <div class="achievement-item">
                    <div class="achievement-icon">ğŸŒˆ</div>
                    <div class="achievement-name">å½©è™¹ä¸»é¢˜</div>
                    <div class="achievement-desc">200ç§¯åˆ†</div>
                </div>
                
                <div class="achievement-item">
                    <div class="achievement-icon">ğŸ‘‘</div>
                    <div class="achievement-name">ä¸“å±ç§°å·</div>
                    <div class="achievement-desc">500ç§¯åˆ†</div>
                </div>
                
                <div class="achievement-item">
                    <div class="achievement-icon">ğŸµ</div>
                    <div class="achievement-name">æ‰“å¡éŸ³æ•ˆ</div>
                    <div class="achievement-desc">150ç§¯åˆ†</div>
                </div>
            </div>

            <div class="section-title">ğŸ¯ å®ç‰©å¥–åŠ±</div>
            <div class="task-item">
                <div class="task-icon school">ğŸ“±</div>
                <div class="task-content">
                    <div class="task-name">é¢å¤–æ‰‹æœºæ—¶é—´ 30åˆ†é’Ÿ</div>
                    <div class="task-meta">
                        <span>éœ€è¦ 300ç§¯åˆ†</span>
                        <span class="task-points">å®¶é•¿è®¾ç½®</span>
                    </div>
                </div>
            </div>
            
            <div class="task-item">
                <div class="task-icon home">ğŸ•</div>
                <div class="task-content">
                    <div class="task-name">é€‰æ‹©ä»Šæ™šæ™šé¤</div>
                    <div class="task-meta">
                        <span>éœ€è¦ 200ç§¯åˆ†</span>
                        <span class="task-points">å®¶é•¿è®¾ç½®</span>
                    </div>
                </div>
            </div>

            <div class="task-item">
                <div class="task-icon temp">ğŸ¬</div>
                <div class="task-content">
                    <div class="task-name">å‘¨æœ«çœ‹ç”µå½±</div>
                    <div class="task-meta">
                        <span>éœ€è¦ 500ç§¯åˆ†</span>
                        <span class="task-points">å®¶é•¿è®¾ç½®</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- åº•éƒ¨å¯¼èˆª -->
        <div class="bottom-nav">
            <div class="nav-item active" onclick="switchPage('home', this)">
                <div class="nav-icon">ğŸ </div>
                <div class="nav-label">é¦–é¡µ</div>
            </div>
            <div class="nav-item" onclick="switchPage('tasks', this)">
                <div class="nav-icon">â•</div>
                <div class="nav-label">ä»»åŠ¡</div>
            </div>
            <div class="nav-item" onclick="switchPage('stats', this)">
                <div class="nav-icon">ğŸ“Š</div>
                <div class="nav-label">ç»Ÿè®¡</div>
            </div>
            <div class="nav-item" onclick="switchPage('profile', this)">
                <div class="nav-icon">ğŸ‘¤</div>
                <div class="nav-label">æˆ‘çš„</div>
            </div>
            <div class="nav-item" onclick="switchPage('shop', this)">
                <div class="nav-icon">ğŸ›ï¸</div>
                <div class="nav-label">å•†åŸ</div>
            </div>
        </div>
    </div>

    <script>
        // åˆ¤æ–­ä»»åŠ¡æ˜¯å¦ä¸ºå½“å¤©ä»»åŠ¡
        function isTodayTask(taskElement) {
            const taskMeta = taskElement.querySelector('.task-meta');
            if (!taskMeta) return false;
            
            const metaText = taskMeta.textContent;
            const today = new Date();
            const dayOfWeek = today.getDay(); // 0=å‘¨æ—¥, 1=å‘¨ä¸€, ..., 6=å‘¨å…­
            const dayOfMonth = today.getDate();
            
            // æ¯æ—¥ä»»åŠ¡
            if (metaText.includes('æ¯æ—¥ä»»åŠ¡')) {
                return true;
            }
            
            // å‘¨ä»»åŠ¡åˆ¤æ–­
            const weekdayMap = {
                0: 'å‘¨æ—¥', 1: 'å‘¨ä¸€', 2: 'å‘¨äºŒ', 3: 'å‘¨ä¸‰', 4: 'å‘¨å››', 5: 'å‘¨äº”', 6: 'å‘¨å…­'
            };
            const todayName = weekdayMap[dayOfWeek];
            
            // æ£€æŸ¥æ˜¯å¦åŒ…å«ä»Šå¤©çš„æ˜ŸæœŸ
            if (metaText.includes(todayName)) {
                return true;
            }
            
            // æœˆä»»åŠ¡åˆ¤æ–­
            if (metaText.includes('æ¯æœˆ') && metaText.includes(dayOfMonth + 'å·')) {
                return true;
            }
            
            // æ’é™¤æ˜å¤©æˆ–å…¶ä»–æœªæ¥æ—¶é—´çš„ä»»åŠ¡
            if (metaText.includes('æ˜å¤©') || metaText.includes('ä¸‹å‘¨') || metaText.includes('ä¸‹æœˆ')) {
                return false;
            }
            
            return false;
        }
        
        // è¿‡æ»¤é¦–é¡µä»»åŠ¡ï¼Œåªæ˜¾ç¤ºå½“å¤©ä»»åŠ¡
        function filterTodayTasks() {
            const homePage = document.getElementById('home');
            if (!homePage) return;
            
            const taskItems = homePage.querySelectorAll('.task-item');
            taskItems.forEach(taskItem => {
                if (isTodayTask(taskItem)) {
                    taskItem.classList.remove('hidden-task');
                } else {
                    taskItem.classList.add('hidden-task');
                }
            });
        }

        // é¡µé¢åˆ‡æ¢åŠŸèƒ½
        function switchPage(pageId, navItem) {
            // éšè—æ‰€æœ‰é¡µé¢
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            
            // æ˜¾ç¤ºç›®æ ‡é¡µé¢
            document.getElementById(pageId).classList.add('active');
            
            // æ›´æ–°å¯¼èˆªçŠ¶æ€
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            navItem.classList.add('active');
            
            // å¦‚æœåˆ‡æ¢åˆ°é¦–é¡µï¼Œè¿‡æ»¤æ˜¾ç¤ºå½“å¤©ä»»åŠ¡
            if (pageId === 'home') {
                filterTodayTasks();
            }
        }

        // ä»»åŠ¡æ‰“å¡åŠŸèƒ½
        function toggleTask(button) {
            if (button.classList.contains('completed')) {
                // å–æ¶ˆå®Œæˆ
                button.classList.remove('completed');
                button.innerHTML = '';
                updateProgress(-1);
            } else {
                // æ ‡è®°å®Œæˆ
                button.classList.add('completed');
                button.innerHTML = 'âœ“';
                updateProgress(1);
                showCelebration();
                
                // æ›´æ–°ç§¯åˆ†
                const taskItem = button.closest('.task-item');
                const pointsElement = taskItem.querySelector('.task-points');
                const points = parseInt(pointsElement.textContent.match(/\d+/)[0]);
                updatePoints(points);
            }
        }

        // æ›´æ–°è¿›åº¦
        function updateProgress(change) {
            const completedElement = document.getElementById('completedTasks');
            const totalElement = document.getElementById('totalTasks');
            
            let completed = parseInt(completedElement.textContent) + change;
            let total = parseInt(totalElement.textContent);
            
            completed = Math.max(0, Math.min(completed, total));
            
            completedElement.textContent = completed;
            
            const percentage = (completed / total) * 100;
            document.querySelector('.progress-fill').style.width = percentage + '%';
        }

        // æ›´æ–°ç§¯åˆ†
        function updatePoints(points) {
            const todayPointsElement = document.getElementById('todayPoints');
            const totalPointsElement = document.getElementById('totalPoints');
            
            let todayPoints = parseInt(todayPointsElement.textContent) + points;
            let totalPoints = parseInt(totalPointsElement.textContent.replace(',', '')) + points;
            
            todayPointsElement.textContent = todayPoints;
            totalPointsElement.textContent = totalPoints.toLocaleString();
        }

        // æ˜¾ç¤ºåº†ç¥åŠ¨ç”»
        function showCelebration() {
            const celebration = document.createElement('div');
            celebration.className = 'celebration';
            celebration.innerHTML = 'ğŸ‰';
            document.body.appendChild(celebration);
            
            setTimeout(() => {
                document.body.removeChild(celebration);
            }, 1000);
        }

        // åˆ†ç±»é€‰æ‹©
        function selectCategory(button, category) {
            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            button.classList.add('active');
        }

        // é¢‘ç‡é€‰æ‹©
        function selectFrequency(button, frequency) {
            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            button.parentElement.querySelectorAll('.category-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            button.classList.add('active');
            
            // æ˜¾ç¤º/éšè—ç›¸åº”çš„é€‰é¡¹
            const weeklyOptions = document.getElementById('weeklyOptions');
            const monthlyOptions = document.getElementById('monthlyOptions');
            
            weeklyOptions.style.display = frequency === 'weekly' ? 'block' : 'none';
            monthlyOptions.style.display = frequency === 'monthly' ? 'block' : 'none';
        }

        // æ˜ŸæœŸå‡ é€‰æ‹©ï¼ˆå¯å¤šé€‰ï¼‰
        function toggleWeekday(button, day) {
            button.classList.toggle('active');
        }

        // æ·»åŠ ä»»åŠ¡
        function addTask() {
            const taskName = document.getElementById('taskName').value;
            const taskPoints = document.getElementById('taskPoints').value;
            
            if (!taskName.trim()) {
                alert('è¯·è¾“å…¥ä»»åŠ¡åç§°');
                return;
            }
            
            // æ¨¡æ‹Ÿæ·»åŠ ä»»åŠ¡æˆåŠŸ
            alert(`ä»»åŠ¡"${taskName}"æ·»åŠ æˆåŠŸï¼å¥–åŠ±${taskPoints}ç§¯åˆ†`);
            
            // æ¸…ç©ºè¡¨å•
            document.getElementById('taskName').value = '';
            document.getElementById('taskPoints').value = '1';
            document.getElementById('taskDesc').value = '';
        }

        // ä½¿ç”¨æ¨¡æ¿
        function useTemplate(name, category, points, frequency) {
            document.getElementById('taskName').value = name;
            document.getElementById('taskPoints').value = points;
            
            // é€‰æ‹©å¯¹åº”åˆ†ç±»
            const categoryButtons = document.querySelectorAll('.category-buttons')[0].querySelectorAll('.category-btn');
            categoryButtons.forEach(btn => btn.classList.remove('active'));
            
            if (category === 'school') categoryButtons[0].classList.add('active');
            else if (category === 'home') categoryButtons[1].classList.add('active');
            else if (category === 'temp') categoryButtons[2].classList.add('active');
            
            // é€‰æ‹©å¯¹åº”é¢‘ç‡
            const frequencyButtons = document.querySelectorAll('.category-buttons')[1].querySelectorAll('.category-btn');
            frequencyButtons.forEach(btn => btn.classList.remove('active'));
            
            if (frequency === 'daily') {
                frequencyButtons[0].classList.add('active');
                selectFrequency(frequencyButtons[0], 'daily');
            } else if (frequency === 'weekly') {
                frequencyButtons[1].classList.add('active');
                selectFrequency(frequencyButtons[1], 'weekly');
            } else if (frequency === 'monthly') {
                frequencyButtons[2].classList.add('active');
                selectFrequency(frequencyButtons[2], 'monthly');
            }
        }
        
        // é¡µé¢åˆ‡æ¢å‡½æ•°
        function showPage(pageId) {
            // éšè—æ‰€æœ‰é¡µé¢
            const pages = document.querySelectorAll('.page');
            pages.forEach(page => {
                page.classList.remove('active');
            });
            
            // æ˜¾ç¤ºæŒ‡å®šé¡µé¢
            const targetPage = document.getElementById(pageId);
            if (targetPage) {
                targetPage.classList.add('active');
            }
            
            // æ›´æ–°åº•éƒ¨å¯¼èˆªçŠ¶æ€
            updateNavigation(pageId);
        }
        
        // æ›´æ–°åº•éƒ¨å¯¼èˆªçŠ¶æ€
        function updateNavigation(pageId) {
            const navItems = document.querySelectorAll('.nav-item');
            navItems.forEach(item => item.classList.remove('active'));
            
            // æ ¹æ®é¡µé¢IDè®¾ç½®å¯¹åº”çš„å¯¼èˆªé¡¹ä¸ºæ´»è·ƒçŠ¶æ€
            if (pageId === 'home') {
                navItems[0].classList.add('active');
            } else if (pageId === 'tasks') {
                navItems[1].classList.add('active');
            } else if (pageId === 'stats') {
                navItems[2].classList.add('active');
            } else if (pageId === 'profile' || pageId === 'parent-mode') {
                navItems[3].classList.add('active');
            } else if (pageId === 'shop') {
                navItems[4].classList.add('active');
            }
        }

        // å®¶é•¿ç®¡ç†åŠŸèƒ½
        function switchToParentMode() {
            verifyParentAccess(() => {
                showPage('parent-management');
            });
        }
        
        function switchToChildMode() {
            showPage('profile');
        }
        
        function showRewardManagement() {
            showPage('reward-management');
        }
        
        function backToParentMode() {
            showPage('parent-mode');
        }
        
        function filterRewards(category) {
            const buttons = document.querySelectorAll('#reward-management .category-btn');
            buttons.forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            const rewards = document.querySelectorAll('.reward-item');
            rewards.forEach(reward => {
                if (category === 'all' || reward.dataset.category === category) {
                    reward.style.display = 'flex';
                } else {
                    reward.style.display = 'none';
                }
            });
        }
        
        function showAddReward() {
            document.getElementById('add-reward-modal').style.display = 'block';
        }
        
        function closeAddReward() {
            document.getElementById('add-reward-modal').style.display = 'none';
            
            // æ¸…ç©ºè¡¨å•ï¼ˆä»…åœ¨å…ƒç´ å­˜åœ¨æ—¶ï¼‰
            const rewardName = document.getElementById('rewardName');
            const rewardPoints = document.getElementById('rewardPoints');
            const rewardDescription = document.getElementById('rewardDescription');
            
            if (rewardName) rewardName.value = '';
            if (rewardPoints) rewardPoints.value = '';
            if (rewardDescription) rewardDescription.value = '';
            
            // é‡ç½®å¼¹çª—æ ‡é¢˜å’ŒæŒ‰é’®
            document.querySelector('#add-reward-modal h3').textContent = 'æ·»åŠ æ–°å¥–åŠ±';
            const confirmBtn = document.querySelector('#add-reward-modal .confirm-btn');
            confirmBtn.textContent = 'æ·»åŠ å¥–åŠ±';
            confirmBtn.onclick = addNewReward;
            
            // æ¸…é™¤é€‰ä¸­çŠ¶æ€
            document.querySelectorAll('.icon-option.selected').forEach(btn => {
                btn.classList.remove('selected');
            });
            document.querySelectorAll('.type-option.selected').forEach(btn => {
                btn.classList.remove('selected');
            });
        }
        
        function selectRewardIcon(button, icon) {
            const buttons = button.parentElement.querySelectorAll('.category-btn');
            buttons.forEach(btn => btn.classList.remove('active'));
            button.classList.add('active');
        }
        
        function selectRewardType(button, type) {
            const buttons = button.parentElement.querySelectorAll('.category-btn');
            buttons.forEach(btn => btn.classList.remove('active'));
            button.classList.add('active');
        }
        
        function addNewReward() {
            const name = document.getElementById('rewardName').value;
            const points = document.getElementById('rewardPoints').value;
            const description = document.getElementById('rewardDescription').value;
            
            if (!name || !points) {
                alert('è¯·å¡«å†™å¥–åŠ±åç§°å’Œæ‰€éœ€ç§¯åˆ†');
                return;
            }
            
            // è¿™é‡Œå¯ä»¥æ·»åŠ å®é™…çš„æ·»åŠ é€»è¾‘
            alert('å¥–åŠ±æ·»åŠ æˆåŠŸï¼');
            closeAddReward();
        }
        
        function editReward(id, name, icon, type, points, description) {
            // æ˜¾ç¤ºæ·»åŠ å¥–åŠ±å¼¹çª—ï¼ˆå¤ç”¨ä½œä¸ºç¼–è¾‘å¼¹çª—ï¼‰
            document.getElementById('add-reward-modal').style.display = 'flex';
            
            // å¡«å……ç°æœ‰æ•°æ®
            document.getElementById('rewardName').value = name;
            document.getElementById('rewardPoints').value = points;
            document.getElementById('rewardDescription').value = description;
            
            // è®¾ç½®å›¾æ ‡
            const iconButtons = document.querySelectorAll('.icon-option');
            iconButtons.forEach(btn => {
                btn.classList.remove('selected');
                if (btn.textContent === icon) {
                    btn.classList.add('selected');
                }
            });
            
            // è®¾ç½®ç±»å‹
            const typeButtons = document.querySelectorAll('.type-option');
            typeButtons.forEach(btn => {
                btn.classList.remove('selected');
                if (btn.dataset.type === type) {
                    btn.classList.add('selected');
                }
            });
            
            // ä¿®æ”¹å¼¹çª—æ ‡é¢˜å’ŒæŒ‰é’®æ–‡å­—
            document.querySelector('#add-reward-modal h3').textContent = 'ç¼–è¾‘å¥–åŠ±';
            document.querySelector('#add-reward-modal .confirm-btn').textContent = 'ä¿å­˜ä¿®æ”¹';
            document.querySelector('#add-reward-modal .confirm-btn').onclick = function() {
                updateReward(id);
            };
        }

        function deleteReward(id, name) {
            if (confirm('ç¡®å®šè¦åˆ é™¤å¥–åŠ±"' + name + '"å—ï¼Ÿ')) {
                // æ‰¾åˆ°å¯¹åº”çš„å¥–åŠ±é¡¹ç›®å¹¶åˆ é™¤
                const rewardItems = document.querySelectorAll('.reward-item');
                rewardItems.forEach(item => {
                    const editBtn = item.querySelector('.edit-btn');
                    if (editBtn && editBtn.onclick.toString().includes('editReward(' + id)) {
                        item.remove();
                    }
                });
                
                alert('å¥–åŠ±"' + name + '"å·²åˆ é™¤');
            }
        }

        function updateReward(id) {
            const name = document.getElementById('rewardName').value;
            const points = document.getElementById('rewardPoints').value;
            const description = document.getElementById('rewardDescription').value;
            
            const selectedIcon = document.querySelector('.icon-option.selected');
            const selectedType = document.querySelector('.type-option.selected');
            
            if (!name || !points || !selectedIcon || !selectedType) {
                alert('è¯·å¡«å†™å®Œæ•´ä¿¡æ¯');
                return;
            }
            
            // æ›´æ–°å¯¹åº”çš„å¥–åŠ±é¡¹ç›®
            const rewardItems = document.querySelectorAll('.reward-item');
            rewardItems.forEach(item => {
                const editBtn = item.querySelector('.edit-btn');
                if (editBtn && editBtn.onclick.toString().includes('editReward(' + id)) {
                    // æ›´æ–°æ˜¾ç¤ºå†…å®¹
                    item.querySelector('.task-icon').textContent = selectedIcon.textContent;
                    item.querySelector('.task-name').textContent = name;
                    item.querySelector('.task-meta span:first-child').textContent = 'éœ€è¦ç§¯åˆ†: ' + points;
                    
                    // æ›´æ–°æ•°æ®å±æ€§
                    item.dataset.category = selectedType.dataset.type;
                    
                    // æ›´æ–°æŒ‰é’®çš„onclickå‚æ•°
                    editBtn.onclick = function() {
                        editReward(id, name, selectedIcon.textContent, selectedType.dataset.type, points, description);
                    };
                    
                    const deleteBtn = item.querySelector('.delete-btn');
                    deleteBtn.onclick = function() {
                        deleteReward(id, name);
                    };
                }
            });
            
            // å…³é—­å¼¹çª—
            closeAddReward();
            alert('å¥–åŠ±å·²æ›´æ–°');
        }

        // ä»»åŠ¡ç¼–è¾‘åŠŸèƒ½
        function editTask(id, name, icon, category, points, frequency, deadline) {
            // æ˜¾ç¤ºæ·»åŠ ä»»åŠ¡å¼¹çª—ä½œä¸ºç¼–è¾‘å¼¹çª—
            const modal = document.getElementById('add-task-modal');
            if (modal) {
                modal.style.display = 'flex';
                
                // å¡«å……ç°æœ‰æ•°æ®
                const taskNameInput = document.getElementById('taskName');
                const taskPointsInput = document.getElementById('taskPoints');
                const taskDeadlineInput = document.getElementById('taskDeadline');
                
                if (taskNameInput) taskNameInput.value = name;
                if (taskPointsInput) taskPointsInput.value = points;
                if (taskDeadlineInput && deadline) {
                    // è®¾ç½®æˆªæ­¢æ—¶é—´
                    const today = new Date();
                    today.setHours(parseInt(deadline.split(':')[0]), parseInt(deadline.split(':')[1]), 0, 0);
                    taskDeadlineInput.value = today.toISOString().slice(0, 16);
                }
                
                // è®¾ç½®åˆ†ç±»
                const categoryButtons = document.querySelectorAll('.category-btn');
                categoryButtons.forEach(btn => {
                    btn.classList.remove('selected');
                    if (btn.textContent.includes(getCategoryName(category))) {
                        btn.classList.add('selected');
                    }
                });
                
                // è®¾ç½®é¢‘ç‡
                const frequencyButtons = document.querySelectorAll('.frequency-btn');
                frequencyButtons.forEach(btn => {
                    btn.classList.remove('selected');
                    if (btn.textContent.includes(getFrequencyName(frequency))) {
                        btn.classList.add('selected');
                    }
                });
                
                // ä¿®æ”¹å¼¹çª—æ ‡é¢˜å’ŒæŒ‰é’®æ–‡æœ¬
                const modalTitle = modal.querySelector('h3');
                const confirmBtn = modal.querySelector('.confirm-btn');
                if (modalTitle) modalTitle.textContent = 'ç¼–è¾‘ä»»åŠ¡';
                if (confirmBtn) {
                    confirmBtn.textContent = 'ä¿å­˜ä¿®æ”¹';
                    confirmBtn.onclick = function() {
                        updateTask(id);
                    };
                }
            }
        }

        // ä»»åŠ¡åˆ é™¤åŠŸèƒ½
        function deleteTask(id, name) {
            if (confirm(`ç¡®å®šè¦åˆ é™¤ä»»åŠ¡"${name}"å—ï¼Ÿ`)) {
                // æ‰¾åˆ°å¯¹åº”çš„ä»»åŠ¡å…ƒç´ å¹¶åˆ é™¤
                const taskItems = document.querySelectorAll('.task-item');
                taskItems.forEach(item => {
                    const taskName = item.querySelector('.task-name');
                    if (taskName && taskName.textContent === name) {
                        item.remove();
                        alert('ä»»åŠ¡å·²åˆ é™¤');
                        return;
                    }
                });
            }
        }

        // æ›´æ–°ä»»åŠ¡åŠŸèƒ½
        function updateTask(id) {
            const taskNameInput = document.getElementById('taskName');
            const taskPointsInput = document.getElementById('taskPoints');
            const taskDeadlineInput = document.getElementById('taskDeadline');
            
            if (!taskNameInput || !taskNameInput.value.trim()) {
                alert('è¯·è¾“å…¥ä»»åŠ¡åç§°');
                return;
            }
            
            const name = taskNameInput.value.trim();
            const points = taskPointsInput ? parseInt(taskPointsInput.value) || 10 : 10;
            const deadline = taskDeadlineInput ? taskDeadlineInput.value : '';
            
            // è·å–é€‰ä¸­çš„åˆ†ç±»å’Œé¢‘ç‡
            const selectedCategory = document.querySelector('.category-btn.selected');
            const selectedFrequency = document.querySelector('.frequency-btn.selected');
            
            // æ‰¾åˆ°å¯¹åº”çš„ä»»åŠ¡å…ƒç´ å¹¶æ›´æ–°
            const taskItems = document.querySelectorAll('.task-item');
            taskItems.forEach(item => {
                const editBtn = item.querySelector('.edit-btn');
                if (editBtn && editBtn.onclick.toString().includes(`editTask(${id},`)) {
                    const taskNameEl = item.querySelector('.task-name');
                    const taskPointsEl = item.querySelector('.task-points');
                    
                    if (taskNameEl) taskNameEl.textContent = name;
                    if (taskPointsEl) taskPointsEl.textContent = `+${points}ç§¯åˆ†`;
                    
                    // æ›´æ–°æŒ‰é’®çš„onclickäº‹ä»¶
                    const newCategory = selectedCategory ? getCategoryCode(selectedCategory.textContent) : 'study';
                    const newFrequency = selectedFrequency ? getFrequencyCode(selectedFrequency.textContent) : 'daily';
                    const newDeadline = deadline ? new Date(deadline).toTimeString().slice(0, 5) : '20:00';
                    
                    editBtn.onclick = function() {
                        editTask(id, name, 'ğŸ“š', newCategory, points, newFrequency, newDeadline);
                    };
                    
                    const deleteBtn = item.querySelector('.delete-btn');
                    if (deleteBtn) {
                        deleteBtn.onclick = function() {
                            deleteTask(id, name);
                        };
                    }
                }
            });
            
            // å…³é—­å¼¹çª—
            closeAddTask();
            alert('ä»»åŠ¡å·²æ›´æ–°');
        }

        // è¾…åŠ©å‡½æ•°ï¼šè·å–åˆ†ç±»åç§°
        function getCategoryName(code) {
            const categoryMap = {
                'study': 'å­¦ä¹ ä»»åŠ¡',
                'home': 'å®¶åº­ä»»åŠ¡',
                'life': 'ç”Ÿæ´»ä¹ æƒ¯',
                'temp': 'ä¸´æ—¶ä»»åŠ¡'
            };
            return categoryMap[code] || 'å­¦ä¹ ä»»åŠ¡';
        }

        // è¾…åŠ©å‡½æ•°ï¼šè·å–é¢‘ç‡åç§°
        function getFrequencyName(code) {
            const frequencyMap = {
                'daily': 'æ¯å¤©',
                'weekly': 'æ¯å‘¨',
                'monthly': 'æ¯æœˆ',
                'temp': 'ä¸´æ—¶'
            };
            return frequencyMap[code] || 'æ¯å¤©';
        }

        // è¾…åŠ©å‡½æ•°ï¼šè·å–åˆ†ç±»ä»£ç 
        function getCategoryCode(name) {
            const categoryMap = {
                'å­¦ä¹ ä»»åŠ¡': 'study',
                'å®¶åº­ä»»åŠ¡': 'home',
                'ç”Ÿæ´»ä¹ æƒ¯': 'life',
                'ä¸´æ—¶ä»»åŠ¡': 'temp'
            };
            return categoryMap[name] || 'study';
        }

        // è¾…åŠ©å‡½æ•°ï¼šè·å–é¢‘ç‡ä»£ç 
        function getFrequencyCode(name) {
            const frequencyMap = {
                'æ¯å¤©': 'daily',
                'æ¯å‘¨': 'weekly',
                'æ¯æœˆ': 'monthly',
                'ä¸´æ—¶': 'temp'
            };
            return frequencyMap[name] || 'daily';
        }

        // å…³é—­æ·»åŠ ä»»åŠ¡å¼¹çª—
        function closeAddTask() {
            const modal = document.getElementById('add-task-modal');
            if (modal) {
                modal.style.display = 'none';
                
                // é‡ç½®è¡¨å•
                const taskNameInput = document.getElementById('taskName');
                const taskPointsInput = document.getElementById('taskPoints');
                const taskDeadlineInput = document.getElementById('taskDeadline');
                
                if (taskNameInput) taskNameInput.value = '';
                if (taskPointsInput) taskPointsInput.value = '1';
                if (taskDeadlineInput) {
                    const now = new Date();
                    now.setHours(20, 0, 0, 0);
                    taskDeadlineInput.value = now.toISOString().slice(0, 16);
                }
                
                // é‡ç½®é€‰æ‹©çŠ¶æ€
                document.querySelectorAll('.category-btn, .frequency-btn').forEach(btn => {
                    btn.classList.remove('selected');
                });
                
                // é‡ç½®å¼¹çª—æ ‡é¢˜å’ŒæŒ‰é’®
                const modalTitle = modal.querySelector('h3');
                const confirmBtn = modal.querySelector('.confirm-btn');
                if (modalTitle) modalTitle.textContent = 'æ·»åŠ æ–°ä»»åŠ¡';
                if (confirmBtn) {
                    confirmBtn.textContent = 'æ·»åŠ ä»»åŠ¡';
                    confirmBtn.onclick = addTask;
                }
            }
        }

        // ç¼–è¾‘ä¸ªäººèµ„æ–™ç›¸å…³å‡½æ•°
        function openProfileEditor() {
            document.getElementById('edit-profile-modal').style.display = 'flex';
        }

        function closeProfileEditor() {
            document.getElementById('edit-profile-modal').style.display = 'none';
        }

        function selectAvatar(button, avatar) {
            // ç§»é™¤æ‰€æœ‰å¤´åƒé€‰é¡¹çš„activeçŠ¶æ€
            document.querySelectorAll('.avatar-option').forEach(option => {
                option.classList.remove('active');
                option.style.border = '2px solid #ddd';
            });
            
            // è®¾ç½®å½“å‰é€‰ä¸­çš„å¤´åƒ
            button.classList.add('active');
            button.style.border = '2px solid #007AFF';
        }

        function saveProfile() {
            // è·å–è¡¨å•æ•°æ®
            const selectedAvatar = document.querySelector('.avatar-option.active').textContent;
            const name = document.getElementById('profileName').value;
            const grade = document.getElementById('profileGrade').value;
            const title = document.getElementById('profileTitle').value;
            
            // éªŒè¯è¾“å…¥
            if (!name.trim()) {
                alert('è¯·è¾“å…¥å§“å');
                return;
            }
            
            // æ›´æ–°é¡µé¢ä¸Šçš„ä¸ªäººä¿¡æ¯
            // æ›´æ–°å¤´åƒ
            document.querySelectorAll('.avatar').forEach(avatar => {
                avatar.textContent = selectedAvatar;
            });
            
            // æ›´æ–°å§“å
            document.querySelectorAll('.user-name').forEach(nameElement => {
                if (nameElement.textContent.includes('å°æ˜')) {
                    nameElement.textContent = name;
                }
            });
            
            // æ›´æ–°å¹´çº§å’Œç§°å·
            document.querySelectorAll('.user-level').forEach(levelElement => {
                if (levelElement.textContent.includes('åˆä¸­äºŒå¹´çº§')) {
                    levelElement.textContent = `${grade} Â· ${title} Lv.8`;
                }
            });
            
            // æ˜¾ç¤ºæˆåŠŸæç¤º
            alert(`ä¸ªäººèµ„æ–™å·²æ›´æ–°ï¼\nå¤´åƒï¼š${selectedAvatar}\nå§“åï¼š${name}\nå¹´çº§ï¼š${grade}\nç§°å·ï¼š${title}`);
            
            // å…³é—­å¼¹çª—
            closeProfileEditor();
        }

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            // è®¾ç½®é»˜è®¤æˆªæ­¢æ—¶é—´ä¸ºä»Šå¤©æ™šä¸Š8ç‚¹ï¼ˆä»…åœ¨å…ƒç´ å­˜åœ¨æ—¶ï¼‰
            const taskDeadlineElement = document.getElementById('taskDeadline');
            if (taskDeadlineElement) {
                const now = new Date();
                now.setHours(20, 0, 0, 0);
                taskDeadlineElement.value = now.toISOString().slice(0, 16);
            }
            
            // åˆå§‹åŒ–æ—¶è¿‡æ»¤é¦–é¡µä»»åŠ¡ï¼Œåªæ˜¾ç¤ºå½“å¤©ä»»åŠ¡
            filterTodayTasks();
            
            // æ·»åŠ ä¸€äº›äº¤äº’æç¤º
            console.log('ğŸ‰ æ¯æ—¥æ‰“å¡åº”ç”¨åŸå‹å·²åŠ è½½ï¼');
            console.log('ğŸ’¡ æ‚¨å¯ä»¥ç‚¹å‡»ä»»åŠ¡å³ä¾§çš„åœ†åœˆæ¥å®Œæˆæ‰“å¡');
            console.log('ğŸ“± ä½¿ç”¨åº•éƒ¨å¯¼èˆªåˆ‡æ¢ä¸åŒé¡µé¢');
            console.log('âœï¸ ç‚¹å‡»ä¸ªäººä¸­å¿ƒçš„ç¼–è¾‘æŒ‰é’®å¯ä»¥ä¿®æ”¹å¤´åƒå’Œä¸ªäººä¿¡æ¯');
            console.log('ğŸ¤ ç‚¹å‡»è¯­éŸ³æŒ‰é’®å¯ä»¥è¯­éŸ³åˆ›å»ºä»»åŠ¡');
        });

        // è¯­éŸ³è¯†åˆ«ç›¸å…³åŠŸèƒ½
        let recognition = null;
        let isRecording = false;

        function initSpeechRecognition() {
            if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
                const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
                recognition = new SpeechRecognition();
                
                recognition.continuous = false;
                recognition.interimResults = false;
                recognition.lang = 'zh-CN';
                
                recognition.onstart = function() {
                    console.log('è¯­éŸ³è¯†åˆ«å¼€å§‹');
                    isRecording = true;
                    updateVoiceUI(true);
                };
                
                recognition.onresult = function(event) {
                    const result = event.results[0][0].transcript;
                    console.log('è¯†åˆ«ç»“æœ:', result);
                    document.getElementById('taskName').value = result;
                    updateVoiceUI(false);
                    showVoiceStatus(`è¯†åˆ«æˆåŠŸï¼š${result}`, 'success');
                };
                
                recognition.onerror = function(event) {
                    console.error('è¯­éŸ³è¯†åˆ«é”™è¯¯:', event.error);
                    updateVoiceUI(false);
                    let errorMessage = 'è¯­éŸ³è¯†åˆ«å¤±è´¥';
                    switch(event.error) {
                        case 'no-speech':
                            errorMessage = 'æ²¡æœ‰æ£€æµ‹åˆ°è¯­éŸ³ï¼Œè¯·é‡è¯•';
                            break;
                        case 'audio-capture':
                            errorMessage = 'æ— æ³•è®¿é—®éº¦å…‹é£ï¼Œè¯·æ£€æŸ¥æƒé™';
                            break;
                        case 'not-allowed':
                            errorMessage = 'éº¦å…‹é£æƒé™è¢«æ‹’ç»ï¼Œè¯·åœ¨æµè§ˆå™¨è®¾ç½®ä¸­å…è®¸';
                            break;
                        case 'network':
                            errorMessage = 'ç½‘ç»œé”™è¯¯ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥';
                            break;
                    }
                    showVoiceStatus(errorMessage, 'error');
                };
                
                recognition.onend = function() {
                    console.log('è¯­éŸ³è¯†åˆ«ç»“æŸ');
                    isRecording = false;
                    updateVoiceUI(false);
                };
                
                return true;
            } else {
                console.warn('æµè§ˆå™¨ä¸æ”¯æŒè¯­éŸ³è¯†åˆ«');
                return false;
            }
        }

        function toggleVoiceInput() {
            if (!recognition && !initSpeechRecognition()) {
                showVoiceStatus('æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒè¯­éŸ³è¯†åˆ«åŠŸèƒ½', 'error');
                return;
            }
            
            if (isRecording) {
                recognition.stop();
            } else {
                recognition.start();
                showVoiceStatus('æ­£åœ¨è†å¬ï¼Œè¯·è¯´è¯...', 'listening');
            }
        }

        function updateVoiceUI(recording) {
            const voiceBtn = document.getElementById('voiceBtn');
            if (recording) {
                voiceBtn.classList.add('recording');
                voiceBtn.textContent = 'â¹ï¸';
                voiceBtn.title = 'ç‚¹å‡»åœæ­¢å½•éŸ³';
            } else {
                voiceBtn.classList.remove('recording');
                voiceBtn.textContent = 'ğŸ¤';
                voiceBtn.title = 'è¯­éŸ³è¾“å…¥';
            }
        }

        function showVoiceStatus(message, type) {
            const statusDiv = document.getElementById('voiceStatus');
            const statusText = document.getElementById('voiceStatusText');
            
            statusText.textContent = message;
            statusDiv.style.display = 'block';
            
            // æ ¹æ®ç±»å‹è®¾ç½®ä¸åŒçš„æ ·å¼
            switch(type) {
                case 'listening':
                    statusDiv.style.background = '#f0f8ff';
                    statusDiv.style.color = '#007AFF';
                    break;
                case 'success':
                    statusDiv.style.background = '#f0fff4';
                    statusDiv.style.color = '#34c759';
                    break;
                case 'error':
                    statusDiv.style.background = '#fff5f5';
                    statusDiv.style.color = '#ff3b30';
                    break;
            }
            
            // 3ç§’åè‡ªåŠ¨éšè—çŠ¶æ€ä¿¡æ¯ï¼ˆé™¤äº†listeningçŠ¶æ€ï¼‰
            if (type !== 'listening') {
                setTimeout(() => {
                    statusDiv.style.display = 'none';
                }, 3000);
            }
        }

        // å®¶é•¿èº«ä»½éªŒè¯ç›¸å…³å‡½æ•°
        function verifyParentAccess(callback) {
            const password = prompt('è¯·è¾“å…¥å®¶é•¿å¯†ç ä»¥ç»§ç»­æ“ä½œï¼š');
            
            // ç®€å•çš„å¯†ç éªŒè¯ï¼ˆå®é™…åº”ç”¨ä¸­åº”è¯¥ä½¿ç”¨æ›´å®‰å…¨çš„æ–¹å¼ï¼‰
            if (password === '123456') {
                // åˆ‡æ¢åˆ°å®¶é•¿æ¨¡å¼
                document.body.classList.remove('student-mode');
                document.body.classList.add('parent-mode');
                
                if (callback) callback();
                console.log('å®¶é•¿èº«ä»½éªŒè¯æˆåŠŸ');
            } else if (password !== null) {
                alert('å¯†ç é”™è¯¯ï¼Œæ— æ³•è¿›å…¥å®¶é•¿ç®¡ç†æ¨¡å¼');
                console.log('å®¶é•¿èº«ä»½éªŒè¯å¤±è´¥');
            }
        }

        function switchToStudentMode() {
            document.body.classList.remove('parent-mode');
            document.body.classList.add('student-mode');
            console.log('åˆ‡æ¢åˆ°å­¦ç”Ÿæ¨¡å¼');
        }

        // ä»»åŠ¡ç§¯åˆ†ç®¡ç†ç›¸å…³å‡½æ•°
        function openTaskPointsManagement() {
            verifyParentAccess(() => {
                hideAllPages();
                document.getElementById('task-points-management').style.display = 'block';
                console.log('æ‰“å¼€ä»»åŠ¡ç§¯åˆ†ç®¡ç†é¡µé¢');
            });
        }

        function backToParentMode() {
            hideAllPages();
            document.getElementById('parent-management').style.display = 'block';
            console.log('è¿”å›å®¶é•¿ç®¡ç†é¡µé¢');
        }

        function filterTasksByCategory(category) {
            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            document.querySelectorAll('#task-points-management .category-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');

            // è¿‡æ»¤ä»»åŠ¡æ˜¾ç¤º
            const taskItems = document.querySelectorAll('.task-points-item');
            taskItems.forEach(item => {
                if (category === 'all' || item.dataset.category === category) {
                    item.style.display = 'flex';
                } else {
                    item.style.display = 'none';
                }
            });
            
            console.log('ç­›é€‰ä»»åŠ¡ç±»åˆ«:', category);
        }

        let currentEditingTask = null;

        function editTaskPoints(taskName, currentPoints) {
            currentEditingTask = taskName;
            document.getElementById('editTaskName').textContent = taskName;
            document.getElementById('editTaskPointsInput').value = currentPoints;
            document.getElementById('edit-task-points-modal').style.display = 'block';
            console.log('ç¼–è¾‘ä»»åŠ¡ç§¯åˆ†:', taskName, currentPoints);
        }

        function closeEditTaskPoints() {
            document.getElementById('edit-task-points-modal').style.display = 'none';
            currentEditingTask = null;
        }

        function saveTaskPoints() {
            const newPoints = document.getElementById('editTaskPointsInput').value;
            
            if (!newPoints || newPoints < 1 || newPoints > 100) {
                alert('è¯·è¾“å…¥æœ‰æ•ˆçš„ç§¯åˆ†æ•°é‡ï¼ˆ1-100ï¼‰');
                return;
            }

            // æ›´æ–°å¯¹åº”ä»»åŠ¡çš„ç§¯åˆ†æ˜¾ç¤º
            const taskItems = document.querySelectorAll('.task-points-item');
            taskItems.forEach(item => {
                const taskNameElement = item.querySelector('.task-name');
                if (taskNameElement && taskNameElement.textContent === currentEditingTask) {
                    const pointsElement = item.querySelector('.task-points');
                    pointsElement.textContent = `å½“å‰: ${newPoints}ç§¯åˆ†`;
                    
                    // æ›´æ–°ç¼–è¾‘æŒ‰é’®çš„onclickå‚æ•°
                    const editBtn = item.querySelector('.edit-btn');
                    editBtn.onclick = () => editTaskPoints(currentEditingTask, newPoints);
                }
            });

            // æ˜¾ç¤ºæˆåŠŸæç¤º
            alert(`ä»»åŠ¡"${currentEditingTask}"çš„ç§¯åˆ†å·²æ›´æ–°ä¸º${newPoints}åˆ†`);
            
            closeEditTaskPoints();
            console.log('ä¿å­˜ä»»åŠ¡ç§¯åˆ†:', currentEditingTask, newPoints);
        }
    </script>
</body>
</html>